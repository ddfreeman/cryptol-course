<?xml version='1.0' encoding='UTF-8'?> <link href="/github-markdown-css/github-css.css" rel="stylesheet"/> <meta charset="utf-8" content="text/html"/> <div class="gist"> <style class="formula-style"> svg.gh-md-to-html-formula { fill: black; } </style> <div class="gist-file"> <!-- This is the class that is responsible for the boxing! --> <div class="gist-data"> <div class="js-gist-file-update-container js-task-list-container file-box"> <div class="file" id="article-cryptol-style"> <div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px"> <article class="markdown-body entry-content container-lg" itemprop="text"> <h1> <a aria-hidden="true" class="anchor" href="#cryptol-style-guide" id="user-content-cryptol-style-guide"><span aria-hidden="true" class="octicon octicon-link"></span></a>Cryptol Style Guide</h1> <p>This document was crafted from <a href="https://github.com/tibbe/haskell-style-guide/blob/master/haskell-style.html">tibbe's Haskell style guide</a>. This guide covers the major areas of formatting and naming of Cryptol specifications. That said, the overarching goal of writing a Cryptol specification is to make it look as much like the corresponding paper document as possible. So, if there is some clear style in the paper document, follow that as closely as possible and use this guide to fill in any gaps.</p> <h2> <a aria-hidden="true" class="anchor" href="#formatting" id="user-content-formatting"><span aria-hidden="true" class="octicon octicon-link"></span></a>Formatting</h2> <h3> <a aria-hidden="true" class="anchor" href="#line-length" id="user-content-line-length"><span aria-hidden="true" class="octicon octicon-link"></span></a>Line Length</h3> <p>Maximum line length is <em>70 characters</em> (which just happens to be the default <code>set-fill-column</code> width in Emacs).</p> <h3> <a aria-hidden="true" class="anchor" href="#indentation" id="user-content-indentation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Indentation</h3> <p>Tabs are illegal. Use spaces for indenting. Indent your code blocks with <em>4 spaces</em>. Indent the <code>where</code> keyword two spaces to set it apart from the rest of the code and indent the definitions in a <code>where</code> clause 2 spaces. Some examples:</p> <pre lang="cryptol"><code>sayHello : {a} (fin a) =&gt; [a][8] -&gt; [a+7][8] sayHello name = greeting where greeting = "Hello, " # name </code></pre> <h3> <a aria-hidden="true" class="anchor" href="#blank-lines" id="user-content-blank-lines"><span aria-hidden="true" class="octicon octicon-link"></span></a>Blank Lines</h3> <p>One blank line between top-level definitions. No blank lines between type signatures and function definitions.</p> <h3> <a aria-hidden="true" class="anchor" href="#whitespace" id="user-content-whitespace"><span aria-hidden="true" class="octicon octicon-link"></span></a>Whitespace</h3> <p>Surround binary operators with a single space on either side. Use your best judgment for the insertion of spaces around arithmetic operators, but always be consistent about whitespace on either side of a binary operator. Don't insert a space after a lambda (the <code>\</code> symbol).</p> <h3> <a aria-hidden="true" class="anchor" href="#type-definitions" id="user-content-type-definitions"><span aria-hidden="true" class="octicon octicon-link"></span></a>Type Definitions</h3> <p>It is acceptable to keep type variables, type constraints, and argument types on one line iff they fit on one line. It is always acceptable to place type variables, type constraints, and argument types on separate lines.</p> <pre lang="Xcryptol"><code>sayHello : {a} (fin a) =&gt; [a][8] -&gt; [a+7][8] </code></pre> <p>The <code>:</code> should always be surrounded by a single space on either side. This aligns type definitions with value definitions (where the <code>=</code> is also surrounded by a single space on either side). For example,</p> <pre lang="cryptol"><code>a : [32] a = 10 b : [4][32] b = [1, 2, 3, 4] </code></pre> <h3> <a aria-hidden="true" class="anchor" href="#type-constraints" id="user-content-type-constraints"><span aria-hidden="true" class="octicon octicon-link"></span></a>Type Constraints</h3> <p>Type constraints should always be tupleized. The following is incorrect:</p> <pre lang="Xcryptol"><code>func : {a, b} fin a =&gt; fin b =&gt; [a][b] -&gt; [a+b] func _ = undefined </code></pre> <p><code>func</code> should be:</p> <pre lang="cryptol"><code>func : {a, b} (fin a, fin b) =&gt; [a][b] -&gt; [a+b] func _ = undefined </code></pre> <h3> <a aria-hidden="true" class="anchor" href="#data-declarations" id="user-content-data-declarations"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data Declarations</h3> <p>The basecase for <code>=</code> should be surrounded by a single space on either side. This aligns value definitions with type definitions (where the <code>:</code> is also surrounded by a single space on either side). For example,</p> <pre lang="cryptol"><code>fish : [32] fish = 10 </code></pre> <p>When multiple definitions are in the same where clause, align the <code>=</code> with the longest definition. For example,</p> <pre lang="cryptol"><code>horse : [4][32] horse = [1, 2, 3, 4] elephant : [2] elephant = [False, True] </code></pre> <p>Format records as follows:</p> <pre lang="cryptol"><code>Person : { firstName : String 10 , lastName : String 10 , age : Integer } Person = { firstName = "Grizabella" , lastName = "GlamourCat" , age = 16 } </code></pre> <p>Align the elements in a list in the same way. For example,</p> <pre lang="Xcryptol"><code>exceptions = [ InvalidStatusCode , MissingContentHeader , InternalServerError ] </code></pre> <p>Optionally, you can skip the first newline. Use your judgment or try to match the specification you're working from.</p> <pre lang="Xcryptol"><code>directions = [ North , East , South , West ] </code></pre> <h3> <a aria-hidden="true" class="anchor" href="#properties" id="user-content-properties"><span aria-hidden="true" class="octicon octicon-link"></span></a>Properties</h3> <p>Shortcircuit logical operators are preferred to if-then-else in properties. For example,</p> <pre lang="cryptol"><code>property myProperty x = x != 0 ==&gt; (100/x) &lt;= 100 </code></pre> <p>is superior to</p> <pre lang="Xcryptol"><code>property myProperty x = if x != 0 then (100/x) &lt;= 100 else True </code></pre> <h3> <a aria-hidden="true" class="anchor" href="#if-then-else-clauses" id="user-content-if-then-else-clauses"><span aria-hidden="true" class="octicon octicon-link"></span></a>If-then-else clauses</h3> <p>Align if-then-else clauses like you would normal expressions:</p> <pre lang="Xcryptol"><code>foo = if ... then ... else ... </code></pre> <p>The same rule applies in nested where clauses:</p> <pre lang="cryptol"><code>foo x y = z where z = if x == 0x0000 then w where w = if y == 0x0000 then 0x1000 else 0x0010 else 0x0100 </code></pre> <h3> <a aria-hidden="true" class="anchor" href="#where-clauses" id="user-content-where-clauses"><span aria-hidden="true" class="octicon octicon-link"></span></a>Where clauses</h3> <p>Align the <code>=</code> symbols in a where clause when it helps readability.</p> <pre lang="Xcryptol"><code>foo = ... where cat = ... fish = ... dog = ... horse = ... </code></pre> <h2> <a aria-hidden="true" class="anchor" href="#comments" id="user-content-comments"><span aria-hidden="true" class="octicon octicon-link"></span></a>Comments</h2> <h3> <a aria-hidden="true" class="anchor" href="#punctuation" id="user-content-punctuation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Punctuation</h3> <p>Write proper sentences; start with a capital letter and use proper punctuation.</p> <h3> <a aria-hidden="true" class="anchor" href="#top-level-definitions" id="user-content-top-level-definitions"><span aria-hidden="true" class="octicon octicon-link"></span></a>Top-Level Definitions</h3> <p>Comment every top level function (particularly exported functions) using <a href="https://en.wikipedia.org/wiki/Docstring" rel="nofollow">docstring comments</a>, and provide a type signature. The documentation should give enough information to apply the function without looking at the function's definition. A docstring comment must immediately preceed the function it applies to and starts on a new line with <code>/**</code>, followed by any number of lines (preferably starting with <code> *</code>) and ending with the line <code> */</code>.</p> <pre lang="cryptol"><code>/** INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs Here is a docstring comment for the function named foo. INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs This comment will appear in the Cryptol interpreter INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs when you type `:help foo`. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ doccom : [32] -&gt; [32] doccom n = n + 1 </code></pre> <pre lang="Xcryptol"><code>Main&gt; :h doccom doccom : [32] -&gt; [32] Here is a docstring comment for the function named foo. This comment will appear in the Cryptol interpreter when you type `:help foo`. </code></pre> <p>When writing a cryptographic algorithm specification in Cryptol, often the arguments to a function have verbiage in the specification that may be copied into the function documentation. This is considered a good practice provided it does not become too verbose.</p> <h3> <a aria-hidden="true" class="anchor" href="#end-of-line-comments" id="user-content-end-of-line-comments"><span aria-hidden="true" class="octicon octicon-link"></span></a>End-of-Line Comments</h3> <p>Separate end-of-line comments from the code using two spaces.</p> <pre lang="cryptol"><code>modp : [32] -&gt; [32] modp n = n % p where p = 4294967291 // Largest 32 bit prime. </code></pre> <h2> <a aria-hidden="true" class="anchor" href="#naming" id="user-content-naming"><span aria-hidden="true" class="octicon octicon-link"></span></a>Naming</h2> <p>When implementing cryptographic algorithm specifications, match identifiers to the case given in the specification. This helps make the correspondence clear (especially to those more steeped in cryptographic algorithm specifications). Should a specification's identifiers include characters illegal in Cryptol identifiers, underscore is often a reasonable substitute.</p> <p>When not constrained by the above it is probably best to follow Haskell's style:</p> <blockquote> <p>Use camel case (e.g. <code>functionName</code>) when naming functions and upper camel case (e.g. <code>DataType</code>) when naming data types.</p> </blockquote> <p>As well, an apostrophe (<code>'</code>) can be appended to a function name to denote a relationship.</p> <pre lang="Xcryptol"><code>encrypt key plainText = f key plainText decrypt key plainText = f' key plainText </code></pre> <h2> <a aria-hidden="true" class="anchor" href="#curried-vs-uncurried-functions" id="user-content-curried-vs-uncurried-functions"><span aria-hidden="true" class="octicon octicon-link"></span></a>Curried vs. Uncurried Functions</h2> <p>[Curried functions] (<a href="https://en.wikipedia.org/wiki/Currying" rel="nofollow">https://en.wikipedia.org/wiki/Currying</a>) are preferred as they afford [partial application] (<a href="https://en.wikipedia.org/wiki/Partial_application" rel="nofollow">https://en.wikipedia.org/wiki/Partial_application</a>) and tend to reduce the number of parentheses. However, when writing Cryptol against a specification document, individual functions should follow the style of the functions from the document (which will usually be uncurried).</p> <h2> <a aria-hidden="true" class="anchor" href="#argument-order" id="user-content-argument-order"><span aria-hidden="true" class="octicon octicon-link"></span></a>Argument Order</h2> <p>Order arguments so that partial application is most advantageous. For example,</p> <pre lang="Xcryptol"><code>encrypt key plainText = ... </code></pre> <p>is superior to</p> <pre lang="Xcryptol"><code>encrypt plainText key = ... </code></pre> <p>since it is easy to see the utility of <code>encrypt key</code> as a function in its own right.</p> <h3> <a aria-hidden="true" class="anchor" href="#warnings" id="user-content-warnings"><span aria-hidden="true" class="octicon octicon-link"></span></a>Warnings</h3> <p>All Cryptol specifications should load into the Cryptol interpreter without warnings.</p> <h1> <a aria-hidden="true" class="anchor" href="#from-here-you-can-go-somewhere" id="user-content-from-here-you-can-go-somewhere"><span aria-hidden="true" class="octicon octicon-link"></span></a>From here, you can go somewhere!</h1> <p><a href="/labs/Language/Basics.html">- Language Basics</a> <br/> |Style Guide|</p> </article> </div> </div> </div> </div> </div> </div>
