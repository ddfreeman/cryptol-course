<?xml version='1.0' encoding='UTF-8'?> <link href="/github-markdown-css/github-css.css" rel="stylesheet"/> <meta charset="utf-8" content="text/html"/> <div class="gist"> <style class="formula-style"> svg.gh-md-to-html-formula { fill: black; } </style> <div class="gist-file"> <!-- This is the class that is responsible for the boxing! --> <div class="gist-data"> <div class="js-gist-file-update-container js-task-list-container file-box"> <div class="file" id="article-ArithmeticVerifications"> <div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px"> <article class="markdown-body entry-content container-lg" itemprop="text"> <h1> <a aria-hidden="true" class="anchor" href="#introduction" id="user-content-introduction"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h1> <p>These files are a set of examples meant to demonstrate simple verifications of arithmetic implemented in C using Cryptol and SAW. These examples are not meant to be especially deep, but may be useful as a reference and also to demonstrate some limitations of these techniques.</p> <h1> <a aria-hidden="true" class="anchor" href="#prerequisites" id="user-content-prerequisites"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h1> <p>Before working through this lab, you'll need</p> <ul> <li>Cryptol to be installed,</li> <li>the Software Analysis Workbench (SAW) to be installed.</li> </ul> <p>A pre-compiled bitcode file is provided so that you don't need to compile the sample C code. If you want to compile the C code yourself, you'll need to install the <a href="https://clang.llvm.org/" rel="nofollow">Clang C compiler</a>. <strong>SAW usually lags behind Clang releases. Check here (<a href="https://github.com/GaloisInc/saw-script#notes-on-llvm">https://github.com/GaloisInc/saw-script#notes-on-llvm</a>) for a list of supported versions of Clang.</strong></p> <h2> <a aria-hidden="true" class="anchor" href="#skills-youll-learn" id="user-content-skills-youll-learn"><span aria-hidden="true" class="octicon octicon-link"></span></a>Skills You'll Learn</h2> <p>By the end of this lab you will understand how to use SAW to prove equivalence between Cryptol specifications and simple C functions, and know some of the limitations of this technique.</p> <p>You'll also gain experience with the Software Analysis Workbench.</p> <h1> <a aria-hidden="true" class="anchor" href="#getting-started" id="user-content-getting-started"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting Started</h1> <p>The file <em>arithmetic.c</em> contains definitions for the following functions:</p> <ul> <li><code>add_standard</code></li> </ul> <blockquote> <p><strong>Declaration</strong>: <code>uint32_t add_standard( uint16_t a, uint16_t b)</code> <strong>Description</strong>: Adds two 16-bit unsigned integers using built-in addition</p> </blockquote> <ul> <li><code>add_textbook</code></li> </ul> <blockquote> <p><strong>Declaration</strong>: <code>uint32_t add_textbook( uint16_t a, uint16_t b)</code> <strong>Description</strong>: Adds two 16-bit integers, but simulates how this might be done on a restricted 8-bit architecture using a "textbook" algorithm</p> </blockquote> <ul> <li><code>multiply_standard</code></li> </ul> <blockquote> <p><strong>Declaration</strong>: <code>uint32_t multiply_standard( uint16_t a, uint16_t b)</code> <strong>Description</strong>: Multiplies two 16-bit unsigned integers using built-in multiplication</p> </blockquote> <ul> <li><code>multiply_textbook</code></li> </ul> <blockquote> <p><strong>Declaration</strong>: <code>uint32_t multiply_textbook( uint16_t a, uint16_t b)</code> <strong>Description</strong>: Multiplies two 16-bit integers, but simulates how this might be done on a restricted 8-bit architecture using a "textbook" algorithm</p> </blockquote> <ul> <li><code>multiply_karatsuba</code></li> </ul> <blockquote> <p><strong>Declaration</strong>: <code>uint32_t multiply_karatsuba( uint16_t a, uint16_t b)</code> <strong>Description</strong>: Multiplies two 16-bit integers, but uses the Karatsuba multiplication technique as though it was binned on 8-bit bins</p> </blockquote> <p>This set of examples demonstrates how to use Cryptol and SAW to verify that the implementations of these familiar functions are correct and equivalent to one another.</p> <h1> <a aria-hidden="true" class="anchor" href="#walk-through" id="user-content-walk-through"><span aria-hidden="true" class="octicon octicon-link"></span></a>Walk through</h1> <p>The <code>Makefile</code> provided has four targets which drive this set of examples. Running the following commands will drive different portions of this set of examples.</p> <ul> <li> <code>make all</code> (or simply just <code>make</code>)</li> </ul> <p>This builds the binary <code>arithmetic_unit_tests</code> as well as generates the LLVM bitcode file <code>arithmetic_llvm.bc</code>. Running the binary <code>arithmetic_unit_tests</code> runs test vectors through the various arithmetic implementations and allows one to check that they are equal on this sample set.</p> <ul> <li><code>make add_tests</code></li> </ul> <p>This runs the command <code>saw add_llvm.saw</code> which loads <code>add_standard</code> and <code>add_textbook</code> from the generated LLVM bitcode file <code>arithmetic_llvm.bc</code> as well as the additional Cryptol implementation <code>add_cryptol</code>. The the script then asks <code>saw</code> to prove the following facts:</p> <ul> <li> <code>add_standard</code> is equivalent to <code>add_textbook</code> for all inputs</li> <li> <code>add_standard</code> is equivalent to <code>add_cryptol</code> for all inputs</li> <li> <code>add_textbook</code> is equivalent to <code>add_cryptol</code> for all inputs</li> </ul> <p>Note that only two of these facts are necessary to check to demonstrate that all three facts are equivalent. All three are performed for the sake of example. Such redundant checks might be desired to build additional confidence in a system.</p> <ul> <li><code>make multiply_tests</code></li> </ul> <p>This step takes a <em>very</em> long time to complete. Sample output has been copied below from a sample run. If you are interested, there is some research [1] which justifies why the techniques used by Cryptol and SAW have trouble verifying properties such as these.</p> <p>This runs the command <code>saw multiply_llvm.saw</code> which loads <code>multiply_standard</code>, <code>multiply_textbook</code>, and <code>multiply_karatsuba</code> from the generated LLVM bitcode file <code>arithmetic_llvm.bc</code>. Because this takes so long to run, we skip checking against a Cryptol reference as we did for addition. This script checks that:</p> <ul> <li> <code>multiply_standard</code> is equivalent to <code>multiply_textbook</code> for all inputs</li> <li> <code>multiply_standard</code> is equivalent to <code>multiply_karatsuba</code> for all inputs</li> </ul> <p>which is sufficient to demonstrate that these functions are all equivalent.</p> <p>Here is the output of a sample run:</p> <pre><code>[17:32:52.661] Extracting reference term: multiply_standard [17:32:52.696] Extracting implementation term: multiply_textbook [17:32:52.699] Extracting implementation term: multiply_karatsuba [17:32:52.702] Proving equivalence: multiply_standard == multiply_textbook [22:14:04.689] Valid [22:14:04.697] Proving equivalence: multiply_standard == multiply_karatsuba [04:16:05.144] Valid [04:16:05.146] Done. </code></pre> <p>This output resulted from running the provided script on a relatively modest desktop machine. Note that the first and second equivalence checks required approximately 4.25 and 4 hours respectively.</p> <ul> <li><code>make clean</code></li> </ul> <p>This cleans up the workspace and unnecessary generated files.</p> <h1> <a aria-hidden="true" class="anchor" href="#references" id="user-content-references"><span aria-hidden="true" class="octicon octicon-link"></span></a>References</h1> <p>[<a href="https://ieeexplore.ieee.org/document/73590" rel="nofollow">1</a>] Bryant, Randall E. "On the Complexity of VLSI Implementations and Graph Representations of Boolean Functions with Application to Integer Multiplication". Carnegie Mellon University, July 1998.</p> <h1> <a aria-hidden="true" class="anchor" href="#solicitation" id="user-content-solicitation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solicitation</h1> <p>How was your experience with this labs Suggestions are welcome in the form of a ticket on the course GitHub page: <a href="https://github.com/weaversa/cryptol-course/issues">https://github.com/weaversa/cryptol-course/issues</a></p> <h1> <a aria-hidden="true" class="anchor" href="#from-here-you-can-go-somewhere" id="user-content-from-here-you-can-go-somewhere"><span aria-hidden="true" class="octicon octicon-link"></span></a>From here, you can go somewhere!</h1> <table> <thead> <tr> <th align="right"></th> <th align="center"></th> <th></th> </tr> </thead> <tbody> <tr> <td align="right"></td> <td align="center"><a href="/labs/Demos/SAW/Demos.html">^ SAW Demos</a></td> <td></td> </tr> <tr> <td align="right"></td> <td align="center"><strong>Arithmetic Verifications</strong></td> <td><a href="/labs/Demos/SAW/Bittwiddling/Bittwiddling.html">Bit Twiddling &gt;</a></td> </tr> </tbody> </table> </article> </div> </div> </div> </div> </div> </div>
