<?xml version='1.0' encoding='UTF-8'?> <link href="/github-markdown-css/github-css.css" rel="stylesheet"/> <meta charset="utf-8" content="text/html"/> <div class="gist"> <style class="formula-style"> svg.gh-md-to-html-formula { fill: black; } </style> <div class="gist-file"> <!-- This is the class that is responsible for the boxing! --> <div class="gist-data"> <div class="js-gist-file-update-container js-task-list-container file-box"> <div class="file" id="article-BittwiddlingAnswers"> <div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px"> <article class="markdown-body entry-content container-lg" itemprop="text"> <h1> <a aria-hidden="true" class="anchor" href="#introduction" id="user-content-introduction"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h1> <p>Sean Eron Anderson, a former graduate student at Stanford, collected a large set of <a href="https://graphics.stanford.edu/~seander/bithacks.html" rel="nofollow">Bit Twiddling Hacks</a>. This collection has a large number of algorithms which perform relatively simple calculations or test properties (e.g. determine the absolute value) in surprising ways. The code is often opaque; that is, it's not easy to see why (or even if) they actually work. This is a good example of how we can use Cryptol and SAW. With Cryptol, we can write code that is easy to read, and as such we have high confidence it is correct. With SAW, we can compare the Cryptol code against the inscrutable bit twiddling code.</p> <p>This file will contain your code (written in Cryptol, naturally) that you use to validate the correctness of the code written in the corresponding C file <a href="bittwiddling.c"></a>. You should look at the C code to help you figure out the type signature of your Cryptol functions. For example, does the C function return a Boolean value (<code>True</code> or <code>False</code>) or a number? If a number, how many bits is it? Your Cryptol code shouldn't match the C code, but instead should be relatively simple (some are as simple as calling a function that already exists in Cryptol), and they should all be relatively easy to read. We also included some properties to help test your code. After you have completed this code, you should write (from scratch) a SAWscript to compare the two.</p> <h2> <a aria-hidden="true" class="anchor" href="#prerequisites" id="user-content-prerequisites"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h2> <p>Before working through this lab, you'll need</p> <ul> <li>Cryptol to be installed,</li> <li>the Software Analysis Workbench (SAW) to be installed,</li> <li>this module to load successfully, and</li> <li>an editor for completing the exercises in this file.</li> </ul> <p>A pre-compiled bitcode file is provided so that you don't need to compile the sample C code. If you want to compile the C code yourself, you'll need to install the <a href="https://clang.llvm.org/" rel="nofollow">Clang C compiler</a>. <strong>SAW usually lags behind Clang releases. Check here (<a href="https://github.com/GaloisInc/saw-script#notes-on-llvm">https://github.com/GaloisInc/saw-script#notes-on-llvm</a>) for a list of supported versions of Clang.</strong></p> <p>You'll also need experience with</p> <ul> <li>loading modules and evaluating functions in the interpreter,</li> <li>Cryptol's sequence types,</li> <li>manipulating sequences using <code>#</code>, <code>take</code>, <code>split</code>, <code>join</code>, <code>head</code>, <code>tail</code>, and `reverse,</li> <li>writing functions and properties,</li> <li>sequence comprehensions,</li> <li>functions with curried parameters,</li> <li>logical, comparison, arithmetic, indexing, slicing, and conditional operators, and</li> <li>C programming.</li> </ul> <h2> <a aria-hidden="true" class="anchor" href="#skills-youll-learn" id="user-content-skills-youll-learn"><span aria-hidden="true" class="octicon octicon-link"></span></a>Skills You'll Learn</h2> <p>By the end of this lab you will gain experience with</p> <ul> <li>writing functions and properties, and</li> <li>the Software Analysis Workbench.</li> </ul> <h2> <a aria-hidden="true" class="anchor" href="#load-this-module" id="user-content-load-this-module"><span aria-hidden="true" class="octicon octicon-link"></span></a>Load This Module</h2> <p>This lab is a <a href="https://en.wikipedia.org/wiki/Literate_programming" rel="nofollow">literate</a> Cryptol document --- that is, it can be loaded directly into the Cryptol interpreter. Load this module from within the Cryptol interpreter running in the <code>cryptol-course</code> directory with: `</p> <pre lang="Xcryptol"><code>Loading module Cryptol Cryptol&gt; :m labs::Demos::SAW::Bittwiddling::BittwiddlingAnswers Loading module Cryptol Loading module labs::Demos::SAW::Bittwiddling::BittwiddlingAnswers </code></pre> <p>We start by defining a new module for this lab:</p> <pre lang="cryptol"><code>module labs::Demos::SAW::Bittwiddling::BittwiddlingAnswers where </code></pre> <p>You do not need to enter the above into the interpreter; the previous <code>:m ...</code> command loaded this literate Cryptol file automatically. In general, you should run <code>Xcryptol session</code> commands in the interpreter and leave <code>cryptol</code> code alone to be parsed by <code>:m ...</code>.</p> <h3> <a aria-hidden="true" class="anchor" href="#parity" id="user-content-parity"><span aria-hidden="true" class="octicon octicon-link"></span></a>Parity</h3> <p><strong>EXERCISE</strong>: Write a function that finds the parity of an n-bit word. Use the three properties below to help you verify that your function works correctly.</p> <pre lang="cryptol"><code>parity : {n} (fin n) =&gt; [n] -&gt; Bit parity w = foldl (^) False w </code></pre> <pre lang="cryptol"><code>property parity8bitProp = parity 0x01 == True /\ parity 0x00 == False /\ parity 0xff == False /\ parity 0xef == True </code></pre> <pre lang="cryptol"><code>property parity32bitProp = parity 0x00000001 == True /\ parity 0x00000000 == False /\ parity 0xffffffff == False /\ parity 0x7fffffff == True </code></pre> <pre lang="cryptol"><code>property parity64bitProp = parity 0x0000000000000001 == True /\ parity 0x0000000000000000 == False /\ parity 0xffffffffffffffff == False /\ parity 0xffffffff7fffffff == True </code></pre> <h2> <a aria-hidden="true" class="anchor" href="#reverse-a-byte" id="user-content-reverse-a-byte"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reverse a byte</h2> <p><strong>EXERCISE</strong>: Write a function which takes a byte and reverses it. For example, <code>0b10101010</code> should map to <code>0b01010101</code>. Use the property below to verify that your function works correctly.</p> <pre lang="cryptol"><code>reverseByte : [8] -&gt; [8] reverseByte b = reverse b </code></pre> <pre lang="cryptol"><code>property reverseByteProp = reverseByte 0x01 == 0x80 /\ reverseByte 0xaa == 0x55 </code></pre> <h2> <a aria-hidden="true" class="anchor" href="#check-if-a-32-bit-word-has-a-zero-byte" id="user-content-check-if-a-32-bit-word-has-a-zero-byte"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check if a 32-bit word has a zero byte</h2> <p><strong>EXERCISE</strong>: Write a function which takes an n*8-bit word and checks if any one of the bytes is all zeroes. Note that it has to be on a byte boundary and not just anywhere. For example, <code>0x11001111</code> has a zero byte (the second byte) but <code>0x10011111</code> does not (the first byte is <code>0x10</code> while the second byte is <code>0x01</code>). Use the property below to help you verify that your function works correctly.</p> <pre lang="cryptol"><code>anyZeroByte : {n} (fin n) =&gt; [n*8] -&gt; Bit anyZeroByte w = any ((==) 0) bytes where bytes = groupBy`{8} w </code></pre> <pre lang="cryptol"><code>property anyZeroByteProp = anyZeroByte 0x10011001 == False /\ anyZeroByte 0x00112233 == True </code></pre> <h1> <a aria-hidden="true" class="anchor" href="#solicitation" id="user-content-solicitation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solicitation</h1> <p>How was your experience with this labs Suggestions are welcome in the form of a ticket on the course GitHub page: <a href="https://github.com/weaversa/cryptol-course/issues">https://github.com/weaversa/cryptol-course/issues</a></p> <h1> <a aria-hidden="true" class="anchor" href="#from-here-you-can-go-somewhere" id="user-content-from-here-you-can-go-somewhere"><span aria-hidden="true" class="octicon octicon-link"></span></a>From here, you can go somewhere!</h1> <table> <thead> <tr> <th align="right"></th> <th align="center"></th> <th></th> </tr> </thead> <tbody> <tr> <td align="right"></td> <td align="center"><a href="/labs/Demos/SAW/Demos.html">^ SAW Demos</a></td> <td></td> </tr> <tr> <td align="right"><a href="/labs/Demos/SAW/ArithmeticVerifications/ArithmeticVerifications.html">&lt; Arithmetic Verifications</a></td> <td align="center"><strong>Bit Twiddling (Answers)</strong></td> <td></td> </tr> <tr> <td align="right"></td> <td align="center"><a href="/labs/Demos/SAW/Bittwiddling/Bittwiddling.html">? Bit Twiddling</a></td> <td></td> </tr> </tbody> </table> </article> </div> </div> </div> </div> </div> </div>
