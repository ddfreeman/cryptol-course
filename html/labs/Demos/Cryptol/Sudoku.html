<?xml version='1.0' encoding='UTF-8'?> <link href="/github-markdown-css/github-css.css" rel="stylesheet"/> <meta charset="utf-8" content="text/html"/> <div class="gist"> <style class="formula-style"> svg.gh-md-to-html-formula { fill: black; } </style> <div class="gist-file"> <!-- This is the class that is responsible for the boxing! --> <div class="gist-data"> <div class="js-gist-file-update-container js-task-list-container file-box"> <div class="file" id="article-Sudoku"> <div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px"> <article class="markdown-body entry-content container-lg" itemprop="text"> <h1> <a aria-hidden="true" class="anchor" href="#introduction" id="user-content-introduction"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h1> <p>This demo gives an overview of how to solve Sudoku puzzles using Cryptol's interface to automated theorem provers.</p> <h2> <a aria-hidden="true" class="anchor" href="#prerequisites" id="user-content-prerequisites"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h2> <p>Before working through this lab, you'll need</p> <ul> <li>Cryptol to be installed and</li> <li>this module to load successfully.</li> </ul> <p>You'll also need experience with</p> <ul> <li>loading modules and evaluating functions in the interpreter and</li> <li>the <code>:prove</code> and <code>:sat</code> commands.</li> </ul> <h2> <a aria-hidden="true" class="anchor" href="#skills-youll-learn" id="user-content-skills-youll-learn"><span aria-hidden="true" class="octicon octicon-link"></span></a>Skills You'll Learn</h2> <p>By the end of this demo you'll understand a bit more about how Cryptol can use its interface to automated theorem provers to perform computation. Rather than write a search algorithm in Cryptol, one only needs to write a solution checker in Cryptol (much easier) and then let the automated theorem prover carry out the search.</p> <h2> <a aria-hidden="true" class="anchor" href="#load-this-module" id="user-content-load-this-module"><span aria-hidden="true" class="octicon octicon-link"></span></a>Load This Module</h2> <p>This lab is a <a href="https://en.wikipedia.org/wiki/Literate_programming" rel="nofollow">literate</a> Cryptol document --- that is, it can be loaded directly into the Cryptol interpreter. Load this module from within the Cryptol interpreter running in the <code>cryptol-course</code> directory with:</p> <pre lang="Xcryptol"><code>Loading module Cryptol Cryptol&gt; :m labs::Demos::Cryptol::Sudoku Loading module Cryptol Loading module Cryptol Loading module labs::Demos::Cryptol::Sudoku </code></pre> <p>We start by defining a new module for this lab and importing some accessory modules that we will use:</p> <pre lang="cryptol"><code>module labs::Demos::Cryptol::Sudoku where </code></pre> <p>You do not need to enter the above into the interpreter; the previous <code>:m ...</code> command loaded this literate Cryptol file automatically.<br/> In general, you should run <code>Xcryptol session</code> commands in the interpreter and leave <code>cryptol</code> code alone to be parsed by <code>:m ...</code>.</p> <h2> <a aria-hidden="true" class="anchor" href="#sudoku-in-cryptol" id="user-content-sudoku-in-cryptol"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sudoku in Cryptol</h2> <p>On 18 Mar 2009, Galois, Inc. <a href="https://galois.com/blog/2009/03/solving-sudoku-using-cryptol/" rel="nofollow">blogged</a> about how to apply Cryptol to solve <a href="https://en.wikipedia.org/wiki/Sudoku" rel="nofollow">Sudoku</a> puzzles. Cryptol has advanced greatly since that time, but it can still be straightforwardly applied toward Sudoku. Here, we port the original blog entry to a Markdown-Literate Cryptol file, updating the code for syntax and new features and interjecting occasionally. We hope to have done justice to the original.</p> <p>On with the program...</p> <blockquote> <h1> <a aria-hidden="true" class="anchor" href="#solving-sudoku-using-cryptol" id="user-content-solving-sudoku-using-cryptol"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solving Sudoku Using Cryptol</h1> <p>WEDNESDAY, MARCH 18, 2009<br/> <a href="https://galois.com/blog/category/domain-specific-languages/" rel="nofollow">DOMAIN SPECIFIC LANGUAGES</a>, <a href="https://galois.com/blog/category/formal-methods/" rel="nofollow">FORMAL METHODS</a><br/> Galois, Inc.</p> <p>Cryptol is a language tailored for cryptographic algorithms. Sudoku is a popular puzzle the reader is no-doubt already familiar with. We will offer no deep reason why anyone should try to solve Sudoku in Cryptol; other than the very fact that it'd be a shame if we couldn't! Needless to say, Cryptol has not been designed for encoding search algorithms. Nonetheless, some of the features of Cryptol and its associated toolset make it extremely suitable for expressing certain constraint satisfaction problems very concisely; and Sudoku very nicely falls into this category.</p> <h2> <a aria-hidden="true" class="anchor" href="#representing-the-board" id="user-content-representing-the-board"><span aria-hidden="true" class="octicon octicon-link"></span></a>Representing the board</h2> <p>A Sudoku board can be represented in a variety of ways. We will pick the simplest: A sequence of 9 rows, each of which has 9 elements storing the digits. Each digit will require 4 bits; since they range from 1 to 9. So, a good Cryptol type for a board is: <code>[9][9][4]</code></p> </blockquote> <p><strong>INTERJECTION</strong></p> <p>Please excuse us for a second. Cryptol has introduced type aliases. Where the original blog represented a Sudoku number as <code>[4]</code>, we will substitute an alias, and similarly for other common structures:</p> <pre lang="cryptol"><code>/** number in [1..9]; 0 reserved (e.g. for blank) github-markdown-css/ html/ labs/ misc/ scripts/ specs/ type SudokuNum = [4] /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var row, column, or 3x3 square of `Num` github-markdown-css/ html/ labs/ misc/ scripts/ specs/ type SudokuGroup = [9]SudokuNum /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var 9x9 grid of `SudokuNum` github-markdown-css/ html/ labs/ misc/ scripts/ specs/ type SudokuBoard = [9]SudokuGroup </code></pre> <p>(Cryptol 2.6.0 introduced <a href="https://github.com/GaloisInc/cryptol/releases/tag/2.6.0">modular integers</a>, so <code>Z 10</code> would also be a good choice for <code>SudokuNum</code>, but we retain <code>[4]</code> to minimize disruption to the original article.)</p> <p>Sorry, you were saying...?</p> <blockquote> <p>In Cryptol-speak, this type simply represents a sequence of precisely 9 elements, each of which is a sequence of 9 elements themselves, each of which are 4-bit words. (Technically, the type <code>[4]</code> also represents a sequence of precisely 4 elements, each of which are bits. But it's easier to read that as 4-bit words. The type <code>[4]</code> and <code>[4]Bit</code> are synonymous in Cryptol, and can be used interchangeably in all contexts.)</p> <h3> <a aria-hidden="true" class="anchor" href="#recognizing-a-valid-row-column-or-box" id="user-content-recognizing-a-valid-row-column-or-box"><span aria-hidden="true" class="octicon octicon-link"></span></a>Recognizing a valid row, column, or box</h3> <p>Let us tackle a much simpler problem to start with. How would we determine if a given set of 9 numbers form a valid Sudoku row, column, or a box? We should simply check that each number from 1 to 9 appears precisely once in the sequence:</p> </blockquote> <pre lang="cryptol"><code>check : SudokuGroup -&gt; Bit check group = [ contains x | x &lt;- [1 .. 9] ] == ~zero where contains x = [ x == y | y &lt;- group ] != zero </code></pre> <blockquote> <p>We simply iterate over the numbers 1 through 9, and check that the given group contains that number. The function <code>contains</code> iterates through all the elements in the given group, and makes sure one of them is the currently looked for element. (The Cryptol primitive <code>zero</code> is a polymorphic constant representing all <code>False</code>s. The operator <code>~</code> inverts all the bits. Hence, the test <code>== ~zero</code> makes sure all the components are <code>True</code>; and the test <code>!= zero</code> makes sure at least one bit is <code>True</code>.)</p> </blockquote> <p><strong>INTERJECTION</strong></p> <p>Cryptol 2.6.0 also merged <code>Cryptol::Extras</code> into the <code>Prelude</code> (the base module for Cryptol). <code>Cryptol::Extras</code> has numerous utility functions, including these and more:</p> <ul> <li> <code>any</code> and <code>all</code>, which check a bit sequence to determine whether any or all of the elements respectively satisfy a given predicate</li> <li> <code>elem</code>, which returns whether an item is in a sequence</li> <li> <code>map</code>, which applies a function to all items in a sequence, returning the sequence of values returned by the function</li> </ul> <p>So currently, this function could also be defined in terms of simple, reusable helpers as:</p> <pre lang="cryptol"><code>/** whether finite sequence `G` contains element `x` github-markdown-css/ html/ labs/ misc/ scripts/ specs/ contains' : {a, n} (Cmp a, fin n) =&gt; [n]a -&gt; a -&gt; Bit contains' G x = elem x G /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs whether finite sequence `G` contains all items in finite INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs sequence `H` github-markdown-css/ html/ labs/ misc/ scripts/ specs/ supset' : {a, n} (Cmp a, fin n) =&gt; [n]a -&gt; [n]a -&gt; Bit supset' G H = all (contains' G) H /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var whether `SudokuGroup` `G` contains one of each number 1-9 github-markdown-css/ html/ labs/ misc/ scripts/ specs/ check' : SudokuGroup -&gt; Bit check' G = supset' G [1..9] </code></pre> <p>Using <code>elem</code>, <code>contains'</code> checks whether any item in <code>G</code> is equal to <code>x</code> (satisfies <code>(==) x</code>). <code>contains</code> is a curried function, so <code>contains' G</code> checks whether <code>G</code> contains the argument being passed, and <code>supset'</code> maps this over <code>H</code> to determine if <code>G</code> contains all items in <code>H</code>.</p> <p>As a sanity check, we can confirm these are equivalent:</p> <pre lang="cryptol"><code>/** `check` and `check'` are equivalent. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ check_equiv : SudokuGroup -&gt; Bit property check_equiv = check === check' </code></pre> <p>For functions <code>f</code> and <code>g</code> of one argument, <code>f === g</code> is <code>True</code> iff for all <code>x</code>, <code>f x == g x</code>.</p> <p>Anyway, sorry for the interruption.</p> <blockquote> <h3> <a aria-hidden="true" class="anchor" href="#recognizing-a-full-board" id="user-content-recognizing-a-full-board"><span aria-hidden="true" class="octicon octicon-link"></span></a>Recognizing a full board</h3> <p>Given a full Sudoku board, checking it's a valid solution simply amounts to identifying rows, columns, and squares; and <code>check</code>-ing them all, in the above sense. The following Cryptol function accomplishes this task rather concisely:</p> </blockquote> <pre lang="cryptol"><code>valid : SudokuBoard -&gt; Bit valid rows = [ check grp | grp &lt;- rows # columns # squares ] == ~zero where columns = transpose rows regions = transpose [ groupBy`{3} row | row &lt;- rows ] squares = [ join sq | sq &lt;- groupBy`{3} (join regions) ] </code></pre> <blockquote> <p>The function <code>valid</code> receives 9 rows; and calls check on all these rows, columns, and the squares. Columns are easy to compute: we simply use Cryptol's <code>transpose</code> primitive. The squares are slightly more tricky, but not particularly hard. We first group all the rows in length 3 segments, and transpose these to align them, thus forming the regions. Then the squares are simply grouping of the regions 3 elements at a time. It's a good exercise to precisely work out how the squares are formed using the above code, something we encourage the interested reader to do on a rainy afternoon..</p> </blockquote> <p><strong>INTERJECTION</strong></p> <p>We can use <code>all</code> and <code>map</code> here to simplify <code>valid</code>:</p> <pre lang="cryptol"><code>valid' : SudokuBoard -&gt; Bit valid' rows = all check (rows # columns # squares) where columns = transpose rows regions = transpose (map groupBy`{3} rows) squares = map join (groupBy`{3} (join regions)) valid_equiv: SudokuBoard -&gt; Bit property valid_equiv = valid === valid' </code></pre> <p>Alright, enough out of us.</p> <blockquote> <h2> <a aria-hidden="true" class="anchor" href="#solving-sudoku" id="user-content-solving-sudoku"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solving Sudoku</h2> <p>All we have done so far is to recognize a given Sudoku board as valid; we have not written a single line of code to actually fill a partially empty board. The good news is that we do not need to! We have all the bits and pieces ready to go. Sounds too good to be true? Well, read on!</p> <h3> <a aria-hidden="true" class="anchor" href="#enter-formal-methods" id="user-content-enter-formal-methods"><span aria-hidden="true" class="octicon octicon-link"></span></a>Enter Formal Methods</h3> <p>What if I told you that recognizing a valid Sudoku board is sufficient to actually solve one that has empty squares on it, using Cryptol's formal-methods toolbox? The idea is rather simple. But before we get there, we need to take a detour into the Cryptol toolbox.</p> <h3> <a aria-hidden="true" class="anchor" href="#checking-satisfiability" id="user-content-checking-satisfiability"><span aria-hidden="true" class="octicon octicon-link"></span></a>Checking satisfiability</h3> <p>Cryptol's formal-methods tools can perform equivalence, safety, and satisfiability checking. We have talked about the former two in an earlier post. Today, we will look at satisfiability checking only. Given a function <code>f</code>, the satisfiability checking problem asks if there is any <code>x</code> such that <code>f x = True</code>. Here is a simple example. Let:</p> </blockquote> <pre lang="cryptol"><code>f : [8] -&gt; Bit f x = x*x - 7*x + 12 == 0 </code></pre> <blockquote> <p>The function <code>f</code> returns <code>True</code> if its given 8-bit argument is a solution to the quadratic equation <code>x^^2 - 7x + 12 = 0</code>. We have:</p> </blockquote> <pre lang="Xcryptol"><code>labs::Demos::Cryptol::Sudoku&gt; :s base=10 labs::Demos::Cryptol::Sudoku&gt; :sat f Satisfiable f 4 = True (Total Elapsed Time: 0.151s, using "Z3") </code></pre> <blockquote> <p>Indeed, 4 is a solution to this equation. Is there any other solution? It is easy to formulate a similar query using the lambda notation:</p> </blockquote> <pre lang="Xcryptol"><code>labs::Demos::Cryptol::Sudoku&gt; :sat (\x -&gt; f x &amp;&amp; (x != 4)) Satisfiable (\x -&gt; f x &amp;&amp; (x != 4)) 3 = True (Total Elapsed Time: 0.034s, using "Z3") </code></pre> <blockquote> <p>Cryptol tells us 3 is a solution as well! There happen to only be two solutions to this equation; let's verify:</p> </blockquote> <pre lang="Xcryptol"><code>labs::Demos::Cryptol::Sudoku&gt; :sat (\x -&gt; f x &amp;&amp; (x != 4) &amp;&amp; (x != 3)) Unsatisfiable (Total Elapsed Time: 0.034s, using "Z3") </code></pre> <blockquote> <p>Indeed, Cryptol confirms that 3 and 4 are the only 8-bit values that satisfy the equation <code>x^^2 - 7x + 12 = 0</code>. (I should mention that the <code>:sat</code> command is available only in the <code>symbolic</code> and <code>sbv</code> backends of Cryptol; the two main backends of Cryptol that are capable of performing formal-verification.)</p> <h3> <a aria-hidden="true" class="anchor" href="#back-to-sudoku" id="user-content-back-to-sudoku"><span aria-hidden="true" class="octicon octicon-link"></span></a>Back to Sudoku</h3> <p>Remember the valid function that returns <code>True</code> if a given full board is a correctly laid-out Sudoku board? With the magic of satisfiability checking, we can just use that definition to fill in the blanks for us! To illustrate, consider the board below.</p> <a href="/html/images/SudokuPuzzle.png" rel="noopener noreferrer" target="_blank"><img alt="Sudoku Puzzle" data-canonical-src="/html/images/SudokuPuzzle.png" src="/html/images/SudokuPuzzle.png" style="max-width:100%; max-height: 216px;"/></a> <p>How do we encode a board with empty cells in Cryptol? One simple idea is to represent the board as a function: It will take the values of its "empty" cells, and return the full board. In the Cryptol encoding below I have tried to align the variables so that they correspond exactly to the empty cells, and named them row-by-row:</p> </blockquote> <pre lang="cryptol"><code>/** This puzzle from the Cryptol blog has a solution. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ puzzle : [_]SudokuNum -&gt; Bit puzzle [a1, a3, a5, a6, a9, b1, b4, b5, b7, b9, c2, c4, c5, c6, c7, c8, c9 , d1, d2, d4, d6, d7, d8 , e1, e2, e3, e5, e7, e8, e9, f2, f3, f4, f6, f8, f9 , g1, g2, g3, g4, g5, g6, g8 , h1, h3, h5, h6, h9, i1, i4, i5, i7, i9] = valid [[a1, 9, a3, 7, a5, a6, 8, 6, a9], [b1, 3, 1, b4, b5, 5, b7, 2, b9], [ 8, c2, 6, c4, c5, c6, c7, c8, c9], [d1, d2, 7, d4, 5, d6, d7, d8, 6], [e1, e2, e3, 3, e5, 7, e7, e8, e9], [ 5, f2, f3, f4, 1, f6, 7, f8, f9], [g1, g2, g3, g4, g5, g6, 1, g8, 9], [h1, 2, h3, 6, h5, h6, 3, 5, h9], [i1, 5, 4, i4, i5, 8, i7, 7, i9]] </code></pre> <p><strong>INTERJECTION</strong></p> <p>Here, we introduce an <code>_</code>, which leaves it to Cryptol's type verifier to resolve a detail we don't especially care about. There must be some number of cells to fill in (in this case, 53), but that there happen to be 53 in this case is irrelevant.</p> <p>Ahem...sorry.</p> <blockquote> <p>It might take a bit of staring at this definition; but the idea is strikingly simple. Notice that the type of puzzle is <code>[53][4] -&gt; Bit</code>, precisely because there are 53 empty cells. Also, instead of just returning the final board, I simply pass it to the function <code>valid</code>; so that the function <code>puzzle</code> will return <code>True</code> precisely when it is given the correct numbers that solve it! By now, it must be obvious how we'll solve Sudoku in Cryptol: All we need to do is to ask Cryptol to find the right input value to make the function return <code>True</code>, i.e., we need to find a satisfying assignment. Here's the response from Cryptol:</p> </blockquote> <pre lang="Xcryptol"><code>labs::Demos::Cryptol::Sudoku&gt; :sat puzzle Satisfiable puzzle [2, 5, 4, 3, 1, 4, 8, 6, 9, 7, 7, 1, 9, 2, 5, 4, 3, 3, 8, 4, 9, 2, 1, 6, 1, 2, 8, 4, 9, 5, 4, 9, 2, 6, 3, 8, 7, 6, 3, 5, 2, 4, 8, 9, 8, 7, 1, 4, 1, 9, 3, 6, 2] = True (Total Elapsed Time: 0.910s, using "Z3") </code></pre> <blockquote> <p>If we plug-in the numbers we get from Cryptol back into the grid, we get the full solution depicted below. (I used italic for the numbers found by Cryptol.) Well; that's what we set out to do originally; so mission accomplished!</p> <a href="/html/images/SudokuSolution.png" rel="noopener noreferrer" target="_blank"><img alt="Solution to Sudoku Puzzle" data-canonical-src="/html/images/SudokuSolution.png" src="/html/images/SudokuSolution.png" style="max-width:100%; max-height: 216px;"/></a> </blockquote> <p><strong>INTERJECTION</strong></p> <p>For kicks and giggles, let's introduce a property saying the solution is unique:</p> <pre lang="cryptol"><code>/** a solution to the easy puzzle github-markdown-css/ html/ labs/ misc/ scripts/ specs/ puzzle_solution : SudokuBoard puzzle_solution = [[2, 9, 5, 7, 4, 3, 8, 6, 1], [4, 3, 1, 8, 6, 5, 9, 2, 7], [8, 7, 6, 1, 9, 2, 5, 4, 3], [3, 8, 7, 4, 5, 9, 2, 1, 6], [6, 1, 2, 3, 8, 7, 4, 9, 5], [5, 4, 9, 2, 1, 6, 7, 3, 8], [7, 6, 3, 5, 2, 4, 1, 8, 9], [9, 2, 8, 6, 7, 1, 3, 5, 4], [1, 5, 4, 9, 3, 8, 6, 7, 2]] /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var The easy puzzle's solution is valid. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ puzzle_solution_valid : Bit property puzzle_solution_valid = valid puzzle_solution /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var The easy puzzle's solution is unique. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ puzzle_unique : [_]SudokuNum -&gt; Bit property puzzle_unique [a1, a3, a5, a6, a9, b1, b4, b5, b7, b9, c2, c4, c5, c6, c7, c8, c9 , d1, d2, d4, d6, d7, d8 , e1, e2, e3, e5, e7, e8, e9, f2, f3, f4, f6, f8, f9 , g1, g2, g3, g4, g5, g6, g8 , h1, h3, h5, h6, h9, i1, i4, i5, i7, i9] = solution == puzzle_solution \/ ~ valid solution where solution = [[a1, 9, a3, 7, a5, a6, 8, 6, a9], [b1, 3, 1, b4, b5, 5, b7, 2, b9], [ 8, c2, 6, c4, c5, c6, c7, c8, c9], [d1, d2, 7, d4, 5, d6, d7, d8, 6], [e1, e2, e3, 3, e5, 7, e7, e8, e9], [ 5, f2, f3, f4, 1, f6, 7, f8, f9], [g1, g2, g3, g4, g5, g6, 1, g8, 9], [h1, 2, h3, 6, h5, h6, 3, 5, h9], [i1, 5, 4, i4, i5, 8, i7, 7, i9]] </code></pre> <pre lang="Xcryptol"><code>labs::Demos::Cryptol::Sudoku&gt; :prove puzzle_unique Q.E.D. (Total Elapsed Time: 0.813s, using "Z3") </code></pre> <p>But let's be honest: that puzzle is pretty easy. Let's throw in <a href="https://www.conceptispuzzles.com/index.aspx?uri=info/article/424" rel="nofollow">a harder puzzle</a> by Arto Inkala that garnered some publicity in 2010 as the "World's Hardest Sudoku". As recently as 2019, solving this with a dedicated program (albeit to be fair, on a phone app) in under two minutes evidently merits <a href="https://youtu.be/GrCgt42avdE?t=81" rel="nofollow">a YouTube video</a>. Let's see how Cryptol, a SAT solving interface that was not optimized for Sudoku puzzles in particular, fares...</p> <p><a href="/html/images/WHSudokuPuzzle.png" rel="noopener noreferrer" target="_blank"><img alt="World's Hardest Sudoku Puzzle (Arto Inkala)" data-canonical-src="/html/images/WHSudokuPuzzle.png" src="/html/images/WHSudokuPuzzle.png" style="max-width:100%; max-height: 216px;"/></a></p> <pre lang="cryptol"><code>/** INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs Arto Inkala's ["World's Hardest Sudoku"]( INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs https://www.conceptispuzzles.com/index.aspx?uri=info/article/424) INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs has a solution. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ hard_puzzle : [_]SudokuNum -&gt; Bit hard_puzzle [ a2, a3, a4, a5, a6, a7, a8, a9, b1, b2, b5, b6, b7, b8, b9, c1, c3, c4, c6, c8, c9, d1, d3, d4, d5, d7, d8, d9, e1, e2, e3, e4, e8, e9, f1, f2, f3, f5, f6, f7, f9, g1, g2, g4, g5, g6, g7, h1, h2, h5, h6, h7, h9, i1, i3, i4, i5, i6, i8, i9] = valid [[ 8, a2, a3, a4, a5, a6, a7, a8, a9], [b1, b2, 3, 6, b5, b6, b7, b8, b9], [c1, 7, c3, c4, 9, c6, 2, c8, c9], [d1, 5, d3, d4, d5, 7, d7, d8, d9], [e1, e2, e3, e4, 4, 5, 7, e8, e9], [f1, f2, f3, 1, f5, f6, f7, 3, f9], [g1, g2, 1, g4, g5, g6, g7, 6, 8], [h1, h2, 8, 5, h5, h6, h7, 1, h9], [i1, 9, i3, i4, i5, i6, 4, i8, i9]] </code></pre> <pre lang="Xcryptol"><code>labs::Demos::Cryptol::Sudoku&gt; :s base=10 labs::Demos::Cryptol::Sudoku&gt; :sat hard_puzzle Satisfiable hard_puzzle [1, 2, 7, 5, 3, 6, 4, 9, 9, 4, 8, 2, 1, 7, 5, 6, 5, 4, 1, 8, 3, 1, 4, 2, 3, 8, 9, 6, 3, 6, 9, 8, 2, 1, 2, 8, 7, 6, 9, 5, 4, 5, 2, 9, 7, 4, 3, 4, 3, 2, 6, 9, 7, 7, 6, 3, 1, 8, 5, 2] = True (Total Elapsed Time: 2.031s, using "Z3") </code></pre> <p><a href="/html/images/WHSudokuSolution.png" rel="noopener noreferrer" target="_blank"><img alt="Solution to World's Hardest Sudoku Puzzle (Arto Inkala)" data-canonical-src="/html/images/WHSudokuSolution.png" src="/html/images/WHSudokuSolution.png" style="max-width:100%; max-height: 217px;"/></a></p> <p>Not bad. Finally, we should prove that this is unique as well...</p> <pre lang="cryptol"><code>/** a solution to the "World's Hardest Sudoku" github-markdown-css/ html/ labs/ misc/ scripts/ specs/ hard_solution : SudokuBoard hard_solution = [[8, 1, 2, 7, 5, 3, 6, 4, 9], [9, 4, 3, 6, 8, 2, 1, 7, 5], [6, 7, 5, 4, 9, 1, 2, 8, 3], [1, 5, 4, 2, 3, 7, 8, 9, 6], [3, 6, 9, 8, 4, 5, 7, 2, 1], [2, 8, 7, 1, 6, 9, 5, 3, 4], [5, 2, 1, 9, 7, 4, 3, 6, 8], [4, 3, 8, 5, 2, 6, 9, 1, 7], [7, 9, 6, 3, 1, 8, 4, 5, 2]] /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var The hard puzzle's solution is valid. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ hard_solution_valid: Bit property hard_solution_valid = valid hard_solution /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var The "World's Hardest Sudoku" has a unique solution. github-markdown-css/ html/ labs/ misc/ scripts/ specs/ hard_unique : [_]SudokuNum -&gt; Bit property hard_unique [ a2, a3, a4, a5, a6, a7, a8, a9, b1, b2, b5, b6, b7, b8, b9, c1, c3, c4, c6, c8, c9, d1, d3, d4, d5, d7, d8, d9, e1, e2, e3, e4, e8, e9, f1, f2, f3, f5, f6, f7, f9, g1, g2, g4, g5, g6, g7, h1, h2, h5, h6, h7, h9, i1, i3, i4, i5, i6, i8, i9] = solution == hard_solution \/ ~ valid solution where solution = [[ 8, a2, a3, a4, a5, a6, a7, a8, a9], [b1, b2, 3, 6, b5, b6, b7, b8, b9], [c1, 7, c3, c4, 9, c6, 2, c8, c9], [d1, 5, d3, d4, d5, 7, d7, d8, d9], [e1, e2, e3, e4, 4, 5, 7, e8, e9], [f1, f2, f3, 1, f5, f6, f7, 3, f9], [g1, g2, 1, g4, g5, g6, g7, 6, 8], [h1, h2, 8, 5, h5, h6, h7, 1, h9], [i1, 9, i3, i4, i5, i6, 4, i8, i9]] </code></pre> <pre lang="Xcryptol"><code>labs::Demos::Cryptol::Sudoku&gt; :prove hard_unique Q.E.D. (Total Elapsed Time: 5.431s, using "Z3") </code></pre> <p>Okay then. Let's defer to the original for some closing remarks...</p> <blockquote> <h3> <a aria-hidden="true" class="anchor" href="#what-just-happened-here" id="user-content-what-just-happened-here"><span aria-hidden="true" class="octicon octicon-link"></span></a>What just happened here?</h3> <p>Apologies if you were expecting to see Cryptol code that actually searched for the values of the empty cells! Note that we have not written a single line of code that tried to deduce what must go in the empty cells, nor have we implemented a search algorithm. We merely viewed Sudoku as a satisfiability problem, and asked Cryptol's formal-methods tools to find the missing values for us. The necessary search is all done by the underlying formal-methods engine, freeing us from the labor. Yet another instance of telling the computer "what" to do, instead of "how."</p> </blockquote> <blockquote> <p>[<code>Download</code> section with broken link removed]</p> </blockquote> <h1> <a aria-hidden="true" class="anchor" href="#solicitation" id="user-content-solicitation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solicitation</h1> <p>How was your experience with this labs Suggestions are welcome in the form of a ticket on the course GitHub page: <a href="https://github.com/weaversa/cryptol-course/issues">https://github.com/weaversa/cryptol-course/issues</a></p> <h1> <a aria-hidden="true" class="anchor" href="#from-here-you-can-go-somewhere" id="user-content-from-here-you-can-go-somewhere"><span aria-hidden="true" class="octicon octicon-link"></span></a>From here, you can go somewhere!</h1> <table> <thead> <tr> <th align="right"></th> <th align="center"></th> <th></th> </tr> </thead> <tbody> <tr> <td align="right"></td> <td align="center"><a href="/labs/Demos/Cryptol/Demos.html">^ Cryptol Demos</a></td> <td></td> </tr> <tr> <td align="right"><a href="/labs/Demos/Cryptol/NQueens.html">&lt; n-Queens</a></td> <td align="center"><strong>Sudoku</strong></td> <td></td> </tr> </tbody> </table> </article> </div> </div> </div> </div> </div> </div>
