<?xml version='1.0' encoding='UTF-8'?> <link href="/github-markdown-css/github-css.css" rel="stylesheet"/> <meta charset="utf-8" content="text/html"/> <div class="gist"> <style class="formula-style"> svg.gh-md-to-html-formula { fill: black; } </style> <div class="gist-file"> <!-- This is the class that is responsible for the boxing! --> <div class="gist-data"> <div class="js-gist-file-update-container js-task-list-container file-box"> <div class="file" id="article-RailFenceAnswers"> <div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px"> <article class="markdown-body entry-content container-lg" itemprop="text"> <h1> <a aria-hidden="true" class="anchor" href="#introduction" id="user-content-introduction"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h1> <p>This module presents the <a href="https://en.wikipedia.org/wiki/Transposition_cipher#Rail_Fence_cipher" rel="nofollow">Rail Fence</a> transposition cipher, in which a message is placed one character at a time on "rails" in a zigzag pattern. This cipher is very simple on paper, but is somewhat of a challenge to specify in Cryptol.</p> <h2> <a aria-hidden="true" class="anchor" href="#prerequisites" id="user-content-prerequisites"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h2> <p>Before working through this lab, you'll need</p> <ul> <li>Cryptol to be installed and</li> <li>this module to load successfully.</li> </ul> <p>You'll also need experience with</p> <ul> <li>loading modules and evaluating functions in the interpreter and</li> <li>the <code>:prove</code> and <code>:sat</code> commands</li> <li>...</li> </ul> <p>For a background on Rail Fence, we recommend perusing the Wikipedia entries on <a href="https://en.wikipedia.org/wiki/Transposition_cipher" rel="nofollow">transposition ciphers</a> in general and <a href="https://en.wikipedia.org/wiki/Transposition_cipher#Rail_Fence_cipher" rel="nofollow">Rail Fence</a> in particular (including the <a href="https://en.wikipedia.org/wiki/Rail_fence_cipher" rel="nofollow">main article</a>).</p> <h2> <a aria-hidden="true" class="anchor" href="#skills-youll-learn" id="user-content-skills-youll-learn"><span aria-hidden="true" class="octicon octicon-link"></span></a>Skills You'll Learn</h2> <p>Specifying Rail Fence will provide a strong foundation with Cryptol data structures and manipulation, upon which to specify more realistic transposition ciphers and other crypto algorithms.</p> <h2> <a aria-hidden="true" class="anchor" href="#load-this-module" id="user-content-load-this-module"><span aria-hidden="true" class="octicon octicon-link"></span></a>Load This Module</h2> <p>This lab is a <a href="https://en.wikipedia.org/wiki/Literate_programming" rel="nofollow">literate</a> Cryptol document --- that is, it can be loaded directly into the Cryptol interpreter. Load this module from within the Cryptol interpreter running in the <code>cryptol-course</code> directory with:</p> <pre lang="Xcryptol"><code>Cryptol&gt; :m labs::Transposition::RailFenceAnswers Loading module Cryptol Loading module Cryptol Loading module specs::Primitive::Symmetric::Cipher::Block::Cipher Loading module specs::Primitive::Symmetric::Cipher::Block::DES Loading module labs::CryptoProofs::CryptoProofsAnswers Loading module labs::Transposition::CommonPropertiesAnswers Loading module labs::Transposition::TranspositionAnswers Loading module labs::Transposition::RailFenceAnswers </code></pre> <p>We start by defining the module for this lab:</p> <pre lang="cryptol"><code>module labs::Transposition::RailFenceAnswers where </code></pre> <p>Additionally, we will import some common properties and transposition cipher components to this spec:</p> <pre lang="cryptol"><code>import labs::Transposition::TranspositionAnswers </code></pre> <h1> <a aria-hidden="true" class="anchor" href="#rail-fence" id="user-content-rail-fence"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rail Fence</h1> <h2> <a aria-hidden="true" class="anchor" href="#example" id="user-content-example"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h2> <p>The aforementioned Wikipedia article presents the example message "WEAREDISCOVEREDFLEEATONCE" for 3 rails. This message is transposed by reading, row-by-row, "WECRLTEERDSOEEFEAOCAIVDEN".</p> <pre lang="cryptol"><code>// For 3 rails: // W . . . E . . . C . . . R . . . L . . . T . . . E // . E . R . D . S . O . E . E . F . E . A . O . C . // . . A . . . I . . . V . . . D . . . E . . . N . . /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var test number of rails github-markdown-css/ html/ labs/ misc/ scripts/ specs/ type test_r = 3 /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var test plaintext github-markdown-css/ html/ labs/ misc/ scripts/ specs/ test_msg = "WEAREDISCOVEREDFLEEATONCE" /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var test ciphertext github-markdown-css/ html/ labs/ misc/ scripts/ specs/ test_msg' = "WECRLTEERDSOEEFEAOCAIVDEN" </code></pre> <p>Given this problem description, our transposition cipher will need to return a permutation based on the length of a message and the number of rails. The main article goes on to describe "cycles", which form Rail Fence's block-like components of the cipher.</p> <p><strong>EXERCISE</strong>: Given a number of rails <code>type r</code>, return the indices occurring in the first cycle. Check your definition using <code>cycle_test</code>. Here's a starter:</p> <p><code>cycle`{r=1} == [0]</code></p> <pre> 0 ... </pre> <p><code>cycle`{r=2} == [0,1]</code></p> <pre> 0 0 ... 1 1 </pre> <p><code>cycle`{r=3} == [0,1,3,2]</code></p> <pre> 0 0 0 ... 1 3 1 3 1 3 2 2 2 </pre> <p><code>cycle`{r=4} == [0,1,5,2,4,3]</code></p> <pre> 0 0 0 ... 1 5 1 5 1 5 2 4 2 4 2 4 3 3 3 </pre> <p>(Hint: Your definition will most likely include logic distinguishing the top, bottom, and middle rails. You might wish to implement a helper function that keeps this distinction intact for computation of <code>pi</code> in the next step.)</p> <pre lang="cryptol"><code>/** indices per cycle, tupled github-markdown-css/ html/ labs/ misc/ scripts/ specs/ cycle': {r} (fin r, r &gt;= 1) =&gt; ([width (max 1 (2*(r - 1)))], [max 2 r - 2][2][width (max 1 (2*(r - 1)))], [width (max 1 (2*(r - 1)))]) cycle' = (0, m, `r - 1) where ml = take`{max 2 r - 2} [1...] mr = reverse (take`{max 2 r - 2} [`r...]) m = transpose [ ml, mr ] /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var indices per cycle github-markdown-css/ html/ labs/ misc/ scripts/ specs/ cycle: {r} (fin r, r &gt;= 1) =&gt; [max 1 (2*(r - 1))][width (max 1 (2*(r - 1)))] cycle = take`{max 1 (2*(r - 1))} ([0] # join m # [`r - 1]) where ml = take`{max 2 r - 2} [1...] mr = reverse (take`{max 2 r - 2} [`r...]) m = transpose [ ml, mr ] /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var `cycle` is defined correctly for various numbers of rails github-markdown-css/ html/ labs/ misc/ scripts/ specs/ property cycle_test = and [ cycle`{1} == [0] , cycle`{2} == [0,1] , cycle`{3} == [0,1,3,2] , cycle`{4} == [0,1,5,2,4,3] ] </code></pre> <pre lang="Xcryptol"><code>labs::Transposition::RailFenceAnswers&gt; :check cycle_test Using exhaustive testing. Passed 1 tests. Q.E.D. </code></pre> <p>Having broken down a Rail Fence message into cycles, we can try to define <code>pi</code> for an arbitrary message length. All that remains is to increment subsequent indices by a multiple of the cycle length and process the resulting indices in the correct order, along each rail.</p> <p><strong>EXERCISE</strong>: Bearing in mind that <code>+</code> is defined structurally (e.g. <code>(0,[[1,5],[2,4]],3) + (6,[[6,6],[6,6]],6)</code> is a valid expression), define <code>pi</code> and <code>pi'</code> to return a correct order for a Rail Fence encryption, again given the number of rails <code>type r</code> and sequence length <code>type n</code>. (You'll have to add <code>r</code> as a type parameter.)<br/> Use <code>pi_test</code> to check your definition.</p> <pre lang="cryptol"><code>/** condensed indices to encrypt message of length `m` over number of additional rails `r` github-markdown-css/ html/ labs/ misc/ scripts/ specs/ pi: {r, n} (fin r, r &gt;= 1, fin n) =&gt; [n][width n] pi = out where (a,b,c) = cycle'`{r} groups = [ ( zext a, [map zext _b | _b &lt;- b], zext c ) + ( o, take (repeat [o,o]), o) | o &lt;- take`{max 1 (n /^ (max 1 (2*(r-1))))} ([0...] INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs repeat (`(max 1 (2*(r-1))))) ] idxs = groups.0 # join (join (transpose (groups.1))) # groups.2 out = unpad`{n} idxs /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var inverse of condensed pi to decrypt message of length `m` over number of additional rails `r` github-markdown-css/ html/ labs/ misc/ scripts/ specs/ pi': {r, n} (fin r, r &gt;= 1, fin n) =&gt; [n][width n] pi' = inverse pi`{r, n} /Applications /Library /System /Users /Volumes /bin /cores /dev /etc /home /opt /private /sbin /tmp /usr /var tests from [Wikipedia article on Rail Fence Cipher](https://en.wikipedia.org/wiki/Rail_fence_cipher) pass github-markdown-css/ html/ labs/ misc/ scripts/ specs/ property pi_test = and [ encrypt pi`{test_r} "" == "" , encrypt pi`{test_r} test_msg == test_msg' , encrypt pi`{test_r} "I_REALLY_LIKE_PUZZLES" == "IA_EZS_ELYLK_UZERLIPL" , encrypt pi`{1} "" == "" , encrypt pi`{1} test_msg == test_msg , encrypt pi`{1} "I_REALLY_LIKE_PUZZLES" == "I_REALLY_LIKE_PUZZLES" , decrypt pi`{test_r} "" == "" , decrypt pi`{test_r} test_msg' == test_msg , decrypt pi`{test_r} "IA_EZS_ELYLK_UZERLIPL" == "I_REALLY_LIKE_PUZZLES" , decrypt pi`{1} "" == "" , decrypt pi`{1} test_msg == test_msg , decrypt pi`{1} "I_REALLY_LIKE_PUZZLES" == "I_REALLY_LIKE_PUZZLES" ] </code></pre> <pre lang="Xcryptol"><code>labs::Transposition::RailFenceAnswers&gt; :check pi_test Using exhaustive testing. Passed 1 tests. Q.E.D. </code></pre> <h1> <a aria-hidden="true" class="anchor" href="#conclusion" id="user-content-conclusion"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusion</h1> <p>This lab presented the Rail Fence transposition cipher, which is deceptively challenging to specify in Cryptol, but we did it!<br/> Completing this and prior labs should provide a strong foundation from which to specify more realistic transposition ciphers.</p> <h1> <a aria-hidden="true" class="anchor" href="#solicitation" id="user-content-solicitation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solicitation</h1> <p>How was your experience with this labs Suggestions are welcome in the form of a ticket on the course GitHub page: <a href="https://github.com/weaversa/cryptol-course/issues">https://github.com/weaversa/cryptol-course/issues</a></p> <h1> <a aria-hidden="true" class="anchor" href="#from-here-you-can-go-somewhere" id="user-content-from-here-you-can-go-somewhere"><span aria-hidden="true" class="octicon octicon-link"></span></a>From here, you can go somewhere!</h1> <table> <thead> <tr> <th align="right"></th> <th align="center"></th> <th></th> </tr> </thead> <tbody> <tr> <td align="right"></td> <td align="center"><a href="/labs/Transposition/Contents.html">^ Transposition Ciphers</a></td> <td></td> </tr> <tr> <td align="right"><a href="/labs/Transposition/Scytale.html">&lt; Scytale</a></td> <td align="center"><strong>Rail Fence (Answers)</strong></td> <td><a href="/labs/Transposition/Route.html">Route &gt;</a></td> </tr> <tr> <td align="right"></td> <td align="center"><a href="/labs/Transposition/RailFence.html">? Rail Fence</a></td> <td></td> </tr> </tbody> </table> </article> </div> </div> </div> </div> </div> </div>
