<?xml version='1.0' encoding='UTF-8'?> <link href="/github-markdown-css/github-css.css" rel="stylesheet"/> <meta charset="utf-8" content="text/html"/> <div class="gist"> <style class="formula-style"> svg.gh-md-to-html-formula { fill: black; } </style> <div class="gist-file"> <!-- This is the class that is responsible for the boxing! --> <div class="gist-data"> <div class="js-gist-file-update-container js-task-list-container file-box"> <div class="file" id="article-ScytaleAnswers"> <div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px"> <article class="markdown-body entry-content container-lg" itemprop="text"> <h1> <a aria-hidden="true" class="anchor" href="#introduction" id="user-content-introduction"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h1> <p>This module defines a classic transposition "cipher" that encrypts a message by wrapping it around a (virtual) <a href="https://en.wikipedia.org/wiki/Scytale" rel="nofollow">scytale</a>.<br/> The cipher is defined in terms of the <code>labs::Transposition::Transposition</code> library, which defines <code>encrypt</code> and <code>decrypt</code> functions given a permutation mapping reflecting positions on a scytale.</p> <h2> <a aria-hidden="true" class="anchor" href="#prerequisites" id="user-content-prerequisites"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h2> <p>Before working through this lab, you'll need</p> <ul> <li>Cryptol to be installed and</li> <li>this module to load successfully.</li> </ul> <p>You'll also need experience with</p> <ul> <li>loading modules and evaluating functions in the interpreter and</li> <li>the <code>:prove</code> and <code>:sat</code> commands</li> <li>...</li> </ul> <p>For some background, read <a href="https://cryptol.net/files/ProgrammingCryptol.pdf" rel="nofollow"><em>Programming Cryptol</em></a>'s section on Scytale.</p> <h2> <a aria-hidden="true" class="anchor" href="#skills-youll-learn" id="user-content-skills-youll-learn"><span aria-hidden="true" class="octicon octicon-link"></span></a>Skills You'll Learn</h2> <p>This module will demonstrate module imports and sequence manipulation, and offer more practice specifying transposition ciphers.</p> <h2> <a aria-hidden="true" class="anchor" href="#load-this-module" id="user-content-load-this-module"><span aria-hidden="true" class="octicon octicon-link"></span></a>Load This Module</h2> <p>This lab is a <a href="https://en.wikipedia.org/wiki/Literate_programming" rel="nofollow">literate</a> Cryptol document --- that is, it can be loaded directly into the Cryptol interpreter. Load this module from within the Cryptol interpreter running in the <code>cryptol-course</code> directory with:</p> <pre lang="Xcryptol"><code>Cryptol&gt; :m labs::Transposition::ScytaleAnswers Loading module Cryptol Loading module Cryptol Loading module specs::Primitive::Symmetric::Cipher::Block::Cipher Loading module specs::Primitive::Symmetric::Cipher::Block::DES Loading module labs::CryptoProofs::CryptoProofsAnswers Loading module labs::Transposition::CommonPropertiesAnswers Loading module labs::Transposition::TranspositionAnswers Loading module labs::Transposition::ScytaleAnswers </code></pre> <p>We start by defining the module for this lab:</p> <pre lang="cryptol"><code>module labs::Transposition::ScytaleAnswers where </code></pre> <p>Additionally, we will import the common transposition cipher definitions:</p> <pre lang="cryptol"><code>import labs::Transposition::TranspositionAnswers </code></pre> <h1> <a aria-hidden="true" class="anchor" href="#scytale-encryption-and-decryption" id="user-content-scytale-encryption-and-decryption"><span aria-hidden="true" class="octicon octicon-link"></span></a>Scytale Encryption and Decryption</h1> <p>After reading the Scytale section of <em>Programming Cryptol</em>, recall its definitions of <code>scytale</code> and <code>dScytale</code> (refactored slightly):</p> <pre lang="cryptol"><code>scytale: {diameter, row} (fin diameter, fin row) =&gt; String (row INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs diameter) -&gt; String (diameter INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs row) scytale msg = join (transpose msg') where msg' = split msg : [diameter][row]Char dScytale: {diameter, row} (fin diameter, fin row) =&gt; String (diameter INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs row) -&gt; String (row INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs diameter) dScytale msg = join (transpose msg') where msg' = split msg : [row][diameter]Char </code></pre> <p>While informative, this definition only accepts messages whose length is a multiple of the rod diameter:</p> <pre lang="Xcryptol"><code>labs::Transposition::ScytaleAnswers&gt; :s ascii=on labs::Transposition::ScytaleAnswers&gt; scytale`{3} "ATTACKATDAWN" "ACDTKATAWATN" labs::Transposition::ScytaleAnswers&gt; scytale`{3} "ATTACKDAWN" [error] at &lt;interactive&gt;:1:13--1:25: 10 != 3 INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs anything </code></pre> <p><strong>EXERCISE</strong>: Can we account for uneven message lengths and define a similar transposition for any message length and rod diameter?</p> <p>Our strategy will be to rephrase scytale to operate over a permutation mapping with the number of padding characters necessary to reach a multiple of the rod diameter, then use <code>unpad</code> to reduce that mapping back down to the original message length. To support this, Cryptol defines type operators <code>/^</code> and <code>%^</code> to denote the number of blocks and padding length, respective, given message and block size. Revisiting the earlier example, <code>"ATTACKDAWN"</code> is length 10, requiring 4 blocks and 2 padding characters to divide into blocks of size 3:</p> <pre lang="Xcryptol"><code>labs::Transposition::ScytaleAnswers&gt; `numBlocks:Integer where type numBlocks = 10 /^ 3 4 labs::Transposition::ScytaleAnswers&gt; `padLength:Integer where type padLength = 10 %^ 3 2 </code></pre> <p>For our permutation mapping, however, instead of working with specific text (e.g. "ATTACKDAWN"), we work with corresponding indices.</p> <p><strong>EXERCISE</strong>: Define <code>pi</code>, the reduced permutation mapping for a padded message of length <code>n</code> on a scytale of rod diameter <code>r</code>. (The identity permutation is produced from a rod of diameter <code>1</code>.)<br/> Define <code>pi'</code> to be its <code>inverse</code>. Use <code>pi_test</code> to check your definitions.</p> <p>(Hint: consider <code>inverse</code> as a helper function. Yes, for scytale <em>encryption</em>. Bizarre, right?)</p> <pre lang="cryptol"><code>pi: {d, n} (fin d, d &gt;= 1, fin n) =&gt; [n][width n] pi = inverse (unpad`{n} (join (transpose (groupBy`{d} (take`{np} [0...]))))) where type np = n /^ d INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs d pi': {d, n} (fin d, d &gt;= 1, fin n) =&gt; [n][width n] pi' = inverse pi`{d} </code></pre> <pre lang="cryptol"><code>property pi_test = and [ encrypt pi`{3} "" == "" , encrypt pi`{3} "ATTACKATDAWN" == "ACDTKATAWATN" , encrypt pi`{3} "ATTACKDAWN" == "ACATKWTDNA" , encrypt pi`{3} "WEAREDISCOVEREDFLEEATONCE" == "WOEEVEAEARRTEEODDNIFCSLEC" , decrypt pi`{3} "" == "" , decrypt pi`{3} "ACDTKATAWATN" == "ATTACKATDAWN" , decrypt pi`{3} "ACATKWTDNA" == "ATTACKDAWN" , decrypt pi`{3} "WOEEVEAEARRTEEODDNIFCSLEC" == "WEAREDISCOVEREDFLEEATONCE" ] </code></pre> <pre lang="Xcryptol"><code>labs::Transposition::ScytaleAnswers&gt; :check pi_test Using exhaustive testing. Passed 1 tests. Q.E.D. </code></pre> <p><strong>EXERCISE</strong>: Can you state an agreement property in terms of <code>scytale</code> and <code>encrypt pi</code> using <code>rearrange</code> or <code>partition</code>? What corner cases must be ruled out? Considering the physical properties of a scytale (as represented by the Wikipedia example), would <code>unpad</code> help here? If not, how can you account for padding? Define <code>pi_correct</code> and use it to verify your definition of <code>pi</code> for various rod diameters and message lengths.</p> <pre lang="cryptol"><code>scy_pad: {d, n} (n &gt;= n / d INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs (n %^ d)) =&gt; (fin d, d &gt;= 1, fin n) =&gt; String n -&gt; String (n /^ d INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs d) scy_pad msg = (msg @@ ixs') # join [ (msg @@ g) # "-" | g &lt;- gixs_] where (ixs', ixs_) = splitAt`{n - (n / d) INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs (n %^ d)} (take`{n} [0...]) gixs_ = split ixs_ : [n %^ d][n / d][width (n /^ d INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs d)] </code></pre> <pre lang="cryptol"><code>pi_correct: {d, n} (n &gt;= n / d INSTALL.md LICENSE README.md cryptol-style.md github-markdown-css html index.html labs misc scripts specs (n %^ d)) =&gt; (fin d, d &gt;= 1, fin n) =&gt; String n -&gt; Bit pi_correct msg = ~ (elem '-' msg) ==&gt; encrypt pi`{d} msg == msg' where msg' = take`{n} (rearrange' (scytale`{d} (scy_pad`{d} msg))) </code></pre> <p>(Note: <code>rearrange'</code> accommodates larger message sizes than <code>rearrange</code>, but proving this property blows up around <code>n = 16</code>.)</p> <pre lang="Xcryptol"><code>labs::Transposition::ScytaleAnswers&gt; :prove pi_correct`{3, 10} Q.E.D. (Total Elapsed Time: 0.141s, using Z3) labs::Transposition::ScytaleAnswers&gt; :prove pi_correct`{3, 12} Q.E.D. (Total Elapsed Time: 0.251s, using Z3) labs::Transposition::ScytaleAnswers&gt; :check pi_correct`{3, 25} Using random testing. Passed 100 tests. Expected test coverage: 0.00% (100 of 2^^200 values) </code></pre> <h1> <a aria-hidden="true" class="anchor" href="#conclusion" id="user-content-conclusion"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusion</h1> <p>This lab presented the Scytale transposition cipher, building upon Galois, Inc.'s previous work to define a more generic version that accommodates arbitrary message sizes and is specified in terms of reusable transposition cipher components.</p> <h1> <a aria-hidden="true" class="anchor" href="#solicitation" id="user-content-solicitation"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solicitation</h1> <p>How was your experience with this labs Suggestions are welcome in the form of a ticket on the course GitHub page: <a href="https://github.com/weaversa/cryptol-course/issues">https://github.com/weaversa/cryptol-course/issues</a></p> <h1> <a aria-hidden="true" class="anchor" href="#from-here-you-can-go-somewhere" id="user-content-from-here-you-can-go-somewhere"><span aria-hidden="true" class="octicon octicon-link"></span></a>From here, you can go somewhere!</h1> <table> <thead> <tr> <th align="right"></th> <th align="center"></th> <th></th> </tr> </thead> <tbody> <tr> <td align="right"></td> <td align="center"><a href="/labs/Transposition/Contents.html">^ Transposition Ciphers</a></td> <td></td> </tr> <tr> <td align="right"><a href="/labs/Transposition/Esrever.html">&lt; Esrever</a></td> <td align="center"><strong>Scytale (Answers)</strong></td> <td><a href="/labs/Transposition/RailFence.html">Rail Fence &gt;</a></td> </tr> <tr> <td align="right"></td> <td align="center"><a href="/labs/Transposition/Scytale.html">? Scytale</a></td> <td></td> </tr> </tbody> </table> </article> </div> </div> </div> </div> </div> </div>
